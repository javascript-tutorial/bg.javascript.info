# Ninja code


```quote author="Confucius"
Ученето без мисъл е загуба на труд, мисълта без учение е опасно.
```

Нинджите програмисти в миналото използвали тези трикове за да изострят ума на хората, които поддържат кода. 

Гурутата, които се занимават с преглеждане на кода, ги търсят в своите тестове. 

Начинаещите програмисти понякога ги използват, дори по-добре от нинджите програмисти. 

Прочети ги внимателно и разбери какъв си ти -- нинджа, начинаещ програмист или рецензент на код? 


```warn header="Irony detected"
Мнозина се опитват да следват пътя на нинджата. Малцина успяват. 
```


## Краткостта е душата на остроумието

Направи кода колкото е възможно по-кратък. Покажи колко си умен.

Нека тънкостите на езика те водят.

Например погледни този тернарен оператор `'?'`:

```js
// взет от добре позната javascript библиотека
i = i ? i < 0 ? Math.max(0, len + i) : i : 0;
```

Супер, нали? Ако пишеш така, програмистът, който чете твоя код ще има трудности да разбере каква е стойността на `i` щом стигне този ред. След това ще дойде да те пита.  

Кажи им, че по-краткия начин винаги е по-добър. Покажи му пътя на нинджата.

## Променливи от една буква

```quote author="Laozi (Tao Te Ching)"
Дао се крие в безмълвието. Само Дао започва и свършва благополучно. 
```

Друг начин да се пише код бързо е като се използват променливи от една буква навсякъде. Като `a`, `b` или `c`.

Кратката променлива изчезва в кода като истинска нинджа в гората. Никой няма да може да я открие като използва "search" на редактора. И дори ако някой успее, той няма да "разбере" какво означава името `a` или `b`.

...Но има и изключения. Истинската нинджа никога няма да използва `i` като брояч във `"for"` цикъл. Навсякъде другаде да, но не и тук. Огледай се наоколо, има много по-екзотични букви. Например `x` или `y`.

Екзотичната променлива като брояч в цикъл е чудесна, особено ако тялото на цикъла заема 1-2 страници (направи го по-дълъг ако можеш). Тогава ако някой погледне цикъла, той няма да успее да разбере веднага, че променлива на име `x` е броячът на цикъла.  

## Използвай съкращения

--- Ако правилата на екипа забраняват използването на променливи от една буква и неясни имена --- използвай съкращения.

Ето така:

- `list` -> `lst`.
- `userAgent` -> `ua`.
- `browser` -> `brsr`.
- ...и тн.

Само онзи с наистина добра интуиция ще успее да разбере такива имена. Опитай се да съкратиш всичко. Само достоен човек ще успее да разбере и поддържа твоя код. 

## Извиси се високо. Бъди абстрактен.

```quote author="Laozi (Tao Te Ching)"
Най-големият квадрат е без ъгли<br>
Най-големият кораб е завършен последен,<br>
Най-великата нота е възвишен звук,<br>
Най-великият образ няма форма.
```

При избора на име използвай възможно най-абстрактната дума като `obj`, `data`, `value`, `item`, `elem` и т.н.

- **Идеалното име за променлива е `data`.** Използвай го където можеш. В действителност всяка променлива съдържа *данни*, нали?

    ...Но какво да правим ако `data` вече е използвано? Пробвай с `value`, това също е универсално име за променлива. Все пак променливата получава *стойност*.

- **Именувай променливата спрямо нейния тип: `str`, `num`...**

    Пробвай. Някой новак може да се чуди -- такива имена на променливи подходящи ли са за една нинджа? Разбира се че са!

    Естествено, името на променливата все още означава нещо. То показва какво има в тази применлива: стринг, число или нещо друго. Но ако външен човек се опита да разбере кода, ще остане изненадан, че в действителност няма никаква информация. И окончателно ще се провали в опитите си да рефакторира твоя добре обмислен код. 

    Типа на променливата може да се установи лесно при дебъгването. Но какво е нейното значение? Кой стринг/число съдържа тя?

    Няма начин да установите това без добра медитация!

- **...Но какво да правя ако повече няма такива имена?** Просто добави число: `data1, item2, elem5`...

## Тест на вниманието

Само наистина внимателен програмист ще успее да разбере твоя код. Но как да провериш това?

**Един от начините е -- използвай близки по изписване имена на променливи, като `date` and `data`.**

Смесвай ги където можеш.

Бърз прочит на такъв код е невъзможен. След това има правописни грешки... Хммм... Това ще бъде дълго, време е за чай.


## Подходящи синоними

```quote author="Confucius"
Най-трудното нещо е да намериш черна котка в тъмна стая, особено ако няма котка.
```

Използването на *подобни* имена за *едни и същи* неща прави живота по-интересен и показва твоята креативност на другите.

Например префиксите на функциите. Ако дадена функция показва съобщение на екрана -- започни я с `display…`, като `displayMessage`. И след това ако друга функция покаже на екрана нещо друго, като user name, започни я с `show…` (като `showName`).

Създай илюзията, че има разлика между тези функции, докато в действителност няма.

Направи пакт с другите нинджи от отбора: ако Джон започва имената на функциите, които "извеждат съобщение" на екрана с `display...` в неговия код, тогава Питър може да използва `render..`, а Ан -- `paint...`. Виж колко по-интересен и разнообразен стана кодът.

...А сега следва номерът с шапката!

За две функции с важни различия -- използвай един и същ префикс!

Например функцията `printPage(page)` ще използва принтер. А функцията `printText(text)` ще изведе текста на екрана. Нека непознатият читател помисли добре над почти еднакво наименуваните функции `printMessage`: "Къде ли ще разпечата съобщението? На принтер или на екрана?". За да заблести наистина, `printMessage(message)` ще го покаже в нов прозирец!

## Преизползване на имена

```quote author="Laozi (Tao Te Ching)"
Когато цялото се раздели, частите<br>
имат нужда от имена.<br>
Вече има достатъчно имена.<br>
Човек трябва да знае кога да спре.
```

Добави нова променлива само когато е абсолютно необходимо.

Вместо това преизползвай съществуващи имена. Просто добави нови стойсности в тях.

Във функция се опитай да използваш само променливите, които се подават като параметри.

Така ще стане наистина трудно да се определи какво точно има в променливата *сега*. И също така от къде идва. Целта е да се развие интуицията и памета на човека, който чете кода. Човек със слаба интуиция ще трябва да анализира кода ред по ред и да проследява промените през всеки code branch (разклонение на кода).

**По-напреднал вариант на този подход е тайно (!) да заместиш стойността с нещо подобно по средата на цикъла или функцията.**

Например:

```js
function ninjaFunction(elem) {
  // 20 реда код, работещи с elem

  elem = clone(elem);

  // още 20 реда, които сега работят с клонинга на elem!
}
```

Колега програмист, който иска да работи с `elem` във втората част на функцията ще се изненада... Само по време на дебъгване, след като проучи кода, той ще открие че работи с копие!

Често се среща в кода. Смъртоносно ефективно дори срещу опитен нинджа.

## Долни черти за забавление

Сложи долни черти `_` и `__` преди имената на променливите. Като `_name` или `__value`. Ще бъде супер ако само ти знаеш тяхното значение. Или още по-добре, сложи ги просто за забавление, без особено значение. Или нека на различните места означават различни неща. С един изтрел два заека. Първо кодът става дълъг и по-трудно четим и второ, колега програмист може да прекара дълго време, опивайки се да разбере какво означават долните черти.

Умелият нинджа слага долни черти на едно място в кода и ги избягва на други места. Това прави кода още по-труден за поддръжка и увеличава вероятността от бъдещи грешки.

## Покажи любовта си

Нека всички разберат колко великолепни са твоите създания! Имена като `superElement`, `megaFrame` и `niceItem` определено ще просветлят читателя.

От една страна нещо е написано като: `super..`, `mega..`, `nice..` От друга страна -- това не носи никаква информация. Читателят може да реши да потърси скрито значение и да медитира час или два от неговото платено работно време.


## Презастъпване с външните променливи

```quote author="Guan Yin Zi"
Когато си на светло, не можеш да видиш нищо в тъмнината.<br>
Когато си на тъмно, можеш да видиш всичко в светлината.
```

Използвай същите имена на променливи вътре и извън функция. Толкова е просто. Няма нужда от усилия да се измислят нови имена.

```js
let *!*user*/!* = authenticateUser();

function render() {
  let *!*user*/!* = anotherValue();
  ...
  ...many lines...
  ...
  ... // <-- програмист, който иска да работи с user тук и...
  ...
}
```

Програмист, който скочи вътре в `render` верочтно няма да забележи, че има локална променлива `user`, която прикрива външната променлива със същото име.

Той ще се опита да работи с `user` предполагайки, че това е външна променлива, която е резултат от `authenticateUser()`... Капанът щракна! Здравей, дебъгер...


## Странични ефекти навсякъде!

Има функции, които изглежда, че не променят нищо. Като `isReady()`, `checkPermission()`, `findTags()`... За тях се предполага, че правят изчисления, намират и връщат данни, без да променят нищо извън тях. С други думи, без "странични ефекти".

**Наистина красив трик е да добавите "полезно" действие към тези функции освен основната им задача.**

Изразът на неподправена изненада на лицето на твоят колега когато види функция, наименована `is..`, `check..` или `find...` как променя нещо -- определено ще разшири твоите граници на здрав разум.

**Друг начин да изненадате другите, е като върнете нестандартен резултат.**

Покажи твоето оригинално мислене! Нека извикването на `checkPermission` върне не `true/false`, а сложен обект с резултатите от проверката.

Тези програмисти, които се опитат да напишат `if (checkPermission(..))`, ще се чудят защо не работи. Кажи им: "Прочети документацията!". И му дай тази статия.


## Мощни функции!

```quote author="Laozi (Tao Te Ching)"
великият Tao тече навсякъде,<br>
едновременно наляво и надясно.
```

Не ограничавай функцията до това, което е написано в нейното име. Мисли по-широко.

Например функцията `validateEmail(email)` може (освен да провери дали електронната поща е въведена правилно) и да покаже съобщение за грешка и да поиска повторно въвеждане на email-а.

Допълнителните действия не трябва да стават ясни от името на функцията. Истинският нинджа ще ги скрие и в кода. 

**Събирането на няколко действия в една функция защитава кода ти от повторно използване.**

Представи си че друг програмист иска само да провери email-а, а не да отпечатва някакво съобщение. Твоята функция `validateEmail(email)`, която прави и двете, няма да му свърши работа. Така че той няма да прекъсне медитацията ти, за да те пита за нея.

## Обобщение

Всички "съвети" по-горе са от истински код... Понякога писан от опитни програмисти. Може би дори по-опитни от теб ;)

- Следвай някои от тях и кодът ти ще стане пълен с изненади.
- Следвай много от тях и твоят код ще стане наистина твой. Никой няма да иска да го променя.
- Използвай всичките и твоят код ще се превърне в ценен урок за младите програмисти, търсещи просветление.
