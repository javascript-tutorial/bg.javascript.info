# Коментари

Както знаем от темата <info:structure>, коментарите могат да бъдат едноредови започващи с `//` или многоредови : `/* ... */`.

Ние ги ползваме да обясним как и защо работи кодът.

На пръв поглед, коментарите могат да бъдат очевидни, но начинаещите в програмирането често ги използват грешно.

## Лоши коментари

Начинаещите са склонни да използват коментарите за да обяснят "какво става в кода". Като този:

```js
// Този код ще прави тези неща (...) и тези неща (...)
// ...и кой ли знае какво още...
много;
сложен;
код;
```

Но в качественият код, количеството от тези "обясняващи" коментари трябва да бъде минимален. Кодът трябва да бъде лесен за разбиране.

Има страхотно правило за това: "Ако кодът е неясен и изисква коментар, тогава може би трябва да се пренапише".

### Рецепта: Вкарвайте кода в функции

Понякога е полезно да заменим дадено парче код със функция, ето така:

```js
function showPrimes(n) {
  nextPrime:
  for (let i = 2; i < n; i++) {

*!*
    // проверяваме  дали i е просто число
    for (let j = 2; j < i; j++) {
      if (i % j == 0) continue nextPrime;
    }
*/!*

    alert(i);
  }
}
```

По - добрият вариант е като използваме отделна функция за `isPrime`:


```js
function showPrimes(n) {

  for (let i = 2; i < n; i++) {
    *!*if (!isPrime(i)) continue;*/!*

    alert(i);  
  }
}

function isPrime(n) {
  for (let i = 2; i < n; i++) {
    if (n % i == 0) return false;
  }

  return true;
}
```

Сега ние можем да разберем кодът лесно. Самата  функция се превръща в коментар. Такъв код се нарича *самодокументиращ се*

### Рецепта: създавайте функции

Ако имаме толкова дълъг код:

```js
// тук добавяме уиски
for(let i = 0; i < 10; i++) {
  let drop = getWhiskey();
  smell(drop);
  add(drop, glass);
}

// тук добавяме сок
for(let t = 0; t < 3; t++) {
  let tomato = getTomato();
  examine(tomato);
  let juice = press(tomato);
  add(juice, glass);
}

// ...
```

Тогава ще бъде по-добре да рефакторирате кода във функции по този начин:

```js
addWhiskey(glass);
addJuice(glass);

function addWhiskey(container) {
  for(let i = 0; i < 10; i++) {
    let drop = getWhiskey();
    //...
  }
}

function addJuice(container) {
  for(let t = 0; t < 3; t++) {
    let tomato = getTomato();
    //...
  }
}
```

Тук също не са необходими коментари, фукнциите сами по себе си казват какво правят. Няма какво да се коментира.  Също така структурата на кода е по - добре разделена. Ясно е какво прави всяка една функция, какъв вход приема и какво връща.

В действителност не можем напълно да избегнем "описателните" коментари. Съществуват сложни алгоритми и трикове за оптимизация, където те са нужни. Но като цяло трябва да се опитаме да запазим кода прост и самодокументиращ се.

## Добри коментари

Така щом, описателните коментари обикновено са лоши. Кои коментари са добри?

Описващи архитектурата
: Доставяте високо ниво на излгед на компонентите , как те си взаимодеистват,  какъв е контролният поток в различни ситуации. На кратко - гледка от птичи поглед към кода. Има специялен език [UML](https://bg.wikipedia.org/wiki/UML) за създаване на диаграми обясняващи архитектурата на кода. Определено си струва да се научат.

Документирането на параметри на функция и тяхното използване
: Има специялен синтаксис [JSDoc](http://en.wikipedia.org/wiki/JSDoc) който документира функциите: за какво се използват, параметри, и стойност, която се връща.

    Например:
    ```js
    /**
     * Връща x повдигнато на n-та степен.
     *
     * @param {number} x числото което бива повдигнато.
     * @param {number} n Степента, трябва да е положително число.
     * @return {number} х повдинато на n-та степен.
     */
    function pow(x, n) {
      ...
    }
    ```

    Такъв коментар ни позволява да разберем значението на фунцкията и да я използваме във правилният начин без да гледаме кода.

   Между другото, много редактори, като [WebStorm](https://www.jetbrains.com/webstorm/), разпознават функциите много добре, за да извършват въвеждане на данни и различни автоматични проверки на кода.

    Също така има инструменти като  [JSDoc 3](https://github.com/jsdoc3/jsdoc) които генерират HTML - документация от коментари. Може да прочетете повече информация на <http://usejsdoc.org/>.

Защо задачата е решена по този начин?
Това което е написано, е важно. Но това, което *не* е написано може да бъде още по-важно за да разберете какво се случва. Защо задачата е решена по този начин? Кодът не дава този отговор.

    Ако има много начини за решение на тази задача, защо точно този? Особено като този не е от най-очевидните.

    Без такъв коментар следната ситуация е възможна:
    1. Вие (или колегата ви) отваряте код, написан преди време, и виждате, какво трябва да се подобри.
    2. Вие си мислите "Колко глупав съм бил тогава, и колко умен съм сега" , и го пренаписвате в "по-правилният и оптимален варант".
    3. ...Имате желание за пренаписване на кода. Но в процеса виждате че всъщност липсва "по - очевидно" решение. Вие смътно си спомняте защо, защото сте го пробвали отдвана. Връщате се в правилният вариянт, но времето ви е загубено.

    Коментарите които обесняват решението са много важни. Те помагат да се развива процеса на разработвнае по правилният начин.

Има ли сложни тънкости кода? Къде се използват?
Ако кода има нещо сложно и неочевидно , тогава определено си струва да го коментираме. 

## Обобщение

Важен знак, че един разработчик е добър са коментарите: тяхната прецизност и дори отсъствието им.

Добрите коментари ни позволяват да поддържаме добре кода, и като се върнем към него след време да го използваме ефективно.

**Коментирайте това:**

- Цялостна архитектура, високо ниво на изглед.
- Използването на дадена фунцкия.
- Важни решения, особено когато не са веднага очевидни.

**Избягвайте коменатри:**

- Такива които ви казват "как работи кода" и "какво прави".
- Ползвайте ги само тогава ако е невъзможно да направите кода лесен за четене и самоописателен, че да няма нужда от тях .

Коментарите се ползват от инструменти за автоматично документиране като JSDoc3: те ги четът и генерират HTML-docs ( или docs във друг формат).
